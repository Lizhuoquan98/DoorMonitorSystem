<Window xmlns:UControl="clr-namespace:DoorMonitorSystem.UControl"  
        x:Class="DoorMonitorSystem.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DoorMonitorSystem.Views"    
        xmlns:dc="clr-namespace:DoorMonitorSystem.ViewModels" 
        mc:Ignorable="d"
         x:Name="MainWin"
        Title="MainWindow"   
         WindowState="Maximized"
        WindowStyle="None"
        AllowsTransparency="True" 
        WindowStartupLocation="CenterScreen"  >
    <Window.DataContext>
        <dc:MainWindowViewModel/>
    </Window.DataContext>

    <Window.Resources> 
        
    </Window.Resources>
    <Window.Background >
        <ImageBrush ImageSource="/Assets/Images/bg.png" TileMode="None"/>
    </Window.Background>

    <Viewbox Stretch="Uniform">
        <Grid Width="1920" Height="1080">
        <Grid.RowDefinitions>
            <RowDefinition Height="70"/> <!-- Row 0: Increased to 70 for better spacing -->
            <RowDefinition Height="Auto"/> <!-- Row 1: Navigation Bar -->
            <RowDefinition Height="*"/>    <!-- Row 2: Main Content -->
        </Grid.RowDefinitions>

        <!-- Row 0: Header -->
        <Grid Grid.Row="0" Margin="10,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/> <!-- Left: Title & Time -->
                <ColumnDefinition Width="*"/>    <!-- Center: Station Name -->
                <ColumnDefinition Width="Auto"/> <!-- Right: User & Exit -->
            </Grid.ColumnDefinitions>

            <!-- Left: Branding & Time -->
            <StackPanel Grid.Column="0" VerticalAlignment="Center" Orientation="Horizontal">
                <!-- Logo Block -->
                <Border Background="#CC0055AA" CornerRadius="4" Padding="15,5" VerticalAlignment="Center" Margin="0,0,15,0" Height="44">
                    <TextBlock Text="DOOR MON" FontFamily="Impact" FontSize="24" Foreground="White" VerticalAlignment="Center"/>
                </Border>
                
                <StackPanel VerticalAlignment="Center">
                    <TextBlock Text="上位机监视系统" FontFamily="Microsoft YaHei" FontSize="24" FontWeight="Bold" Foreground="White" Margin="0,0,0,0">
                        <TextBlock.Effect>
                            <DropShadowEffect Color="Black" BlurRadius="5" ShadowDepth="2" Opacity="0.5"/>
                        </TextBlock.Effect>
                    </TextBlock>
                    <!-- Time Display (Small, under title) -->
                    <TextBlock Text="{Binding Time}" FontFamily="Consolas" FontSize="18" Foreground="#00FF00"/>
                </StackPanel>
            </StackPanel>

            <!-- Center: Station Name -->
            <Viewbox Grid.Column="1" Height="44" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="10,0">
                <TextBlock Text="{Binding StationName}" FontFamily="Microsoft YaHei" FontWeight="Bold" Foreground="#00FFFF">
                     <TextBlock.Effect>
                        <DropShadowEffect Color="#00FFFF" BlurRadius="10" ShadowDepth="0" Opacity="0.6"/>
                    </TextBlock.Effect>
                </TextBlock>
            </Viewbox>

            <!-- Right: User & Exit -->
            <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                <!-- User Info Card (Clickable) -->
                <Button Command="{Binding OpenUserInfoCommand}"  Style="{StaticResource ActionButton}" Margin="0,0,15,0" Padding="0" Background="Transparent" BorderThickness="0" Height="44">
                    <Border Background="#22FFFFFF" CornerRadius="6" Padding="12,5">
                         <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Path Data="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" 
                                      Fill="#DDD" Width="20" Height="20" Stretch="Uniform" Margin="0,0,10,0"/>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="当前用户" Foreground="#AAA" FontSize="10" HorizontalAlignment="Left"/>
                                <TextBlock Text="{Binding CurrentUserName}" Foreground="White" FontWeight="Bold" FontSize="15" HorizontalAlignment="Left"/>
                            </StackPanel>
                            <!-- Arrow Hint -->
                            <Path Data="M7,10L12,15L17,10H7Z" Fill="#88FFFFFF" Width="10" Height="10" Stretch="Uniform" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </Button>
                
                <Button Content="退出系统" Style="{StaticResource ButtonNavigation}" Width="Auto" FontSize="16" Height="44" Padding="20,0" Margin="0"
                            Command="{Binding ExecuteCommand}" Background="#88FF0000" BorderBrush="#AAFF0000" VerticalAlignment="Center"/>
            </StackPanel>
        </Grid>

        <!-- Row 1: Navigation Bar -->
        <Border Grid.Row="1" Background="#33FFFFFF" BorderBrush="#44FFFFFF" BorderThickness="0,1" Margin="0,0,0,5" Padding="10,2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Function Buttons (Center) -->
                <StackPanel Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <RadioButton Content="主界面" GroupName="NavGroup" IsChecked="True" Style="{StaticResource NavRadioButtonStyle}"
                                 Command="{Binding NavigationCommand}" CommandParameter="{x:Type dc:MainViewModel}" />
                    <RadioButton Content="点表配置" GroupName="NavGroup" Style="{StaticResource NavRadioButtonStyle}"
                                 Command="{Binding NavigationCommand}" CommandParameter="{x:Type dc:DevvarlistViewModel}" />
                    <RadioButton Content="图形编辑" GroupName="NavGroup" Style="{StaticResource NavRadioButtonStyle}"
                                 Command="{Binding NavigationCommand}" CommandParameter="{x:Type dc:GraphicEditingViewModel}" />
                    <RadioButton Content="设备列表" GroupName="NavGroup" Style="{StaticResource NavRadioButtonStyle}" 
                                 Command="{Binding NavigationCommand}" CommandParameter="{x:Type dc:DeployViewModel}" />
                    <RadioButton Content="系统日志" GroupName="NavGroup" Style="{StaticResource NavRadioButtonStyle}"
                                 Command="{Binding NavigationCommand}" CommandParameter="{x:Type dc:SystemLogViewModel}" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- Row 2: Main Content Window -->
        <Border Grid.Row="2" BorderBrush="#33FFFFFF" BorderThickness="1" Margin="10,0,10,10" Background="#11000000">
             <ContentControl Content="{Binding CurrentView}"/> 
        </Border>
    </Grid>
    </Viewbox>
</Window>
 
