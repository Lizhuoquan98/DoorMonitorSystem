<UserControl x:Class="DoorMonitorSystem.Views.LayoutConfigurationView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:vm="clr-namespace:DoorMonitorSystem.ViewModels"
             xmlns:vm_items="clr-namespace:DoorMonitorSystem.ViewModels.ConfigItems"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="1000">

    <UserControl.Resources>
        <!-- Icon Resources (Simulated with Path) -->
        <Style x:Key="IconStyle" TargetType="Path">
            <Setter Property="Width" Value="16"/>
            <Setter Property="Height" Value="16"/>
            <Setter Property="Stretch" Value="Uniform"/>
            <Setter Property="Fill" Value="#555"/>
            <Setter Property="Margin" Value="0,0,5,0"/>
        </Style>

        <!-- TreeView Item Templates -->
        <!-- Right Side Detail Templates -->


        <DataTemplate DataType="{x:Type vm_items:DoorGroupConfigItem}">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/> <!-- Title -->
                    <RowDefinition Height="Auto"/> <!-- Info -->
                    <RowDefinition Height="Auto"/> <!-- Separator -->
                    <RowDefinition Height="Auto"/> <!-- Toolbar -->
                    <RowDefinition Height="*"/>    <!-- DataGrid -->
                    <RowDefinition Height="Auto"/> <!-- Tips -->
                </Grid.RowDefinitions>
                <TextBlock Grid.Row="0" Text="é—¨ç»„é…ç½®" FontSize="18" FontWeight="Bold" Margin="0,0,0,20"/>

                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="120"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Text="é—¨ç»„åç§°:" VerticalAlignment="Center" Margin="5,8"/>
                    <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Entity.GroupName, UpdateSourceTrigger=PropertyChanged}" Margin="5" Padding="5" VerticalContentAlignment="Center" TextChanged="OnNameTextChanged"/>

                    <TextBlock Grid.Row="1" Grid.Column="0" Text="æŽ’åºåºå·:" VerticalAlignment="Center" Margin="5,8"/>
                    <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Entity.SortOrder}" Margin="5" Padding="5" VerticalContentAlignment="Center"/>

                    <TextBlock Grid.Row="2" Grid.Column="0" Text="æŽ’åºæ–¹å¼:" VerticalAlignment="Center" Margin="5,8"/>
                    <ComboBox Grid.Row="2" Grid.Column="1" SelectedValue="{Binding Entity.IsReverseOrder}" SelectedValuePath="Tag" Margin="5" Padding="5" VerticalContentAlignment="Center">
                        <ComboBoxItem Content="é¡ºåº (é»˜è®¤)" >
                            <ComboBoxItem.Tag>
                                <sys:Boolean>False</sys:Boolean>
                            </ComboBoxItem.Tag>
                        </ComboBoxItem>
                        <ComboBoxItem Content="é€†åº (åå‘/å³åˆ°å·¦)" >
                            <ComboBoxItem.Tag>
                                <sys:Boolean>True</sys:Boolean>
                            </ComboBoxItem.Tag>
                        </ComboBoxItem>
                    </ComboBox>
                </Grid>

                <Separator Grid.Row="2" Margin="0,20" Background="#33FFFFFF"/>

                <!-- é—¨ç‚¹è¡¨é…ç½®åŒº -->
                <Grid Grid.Row="3" Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="é—¨ç‚¹è¡¨é…ç½®" FontSize="14" FontWeight="Bold" Foreground="#00FFFF" VerticalAlignment="Center" Margin="5,0,20,0"/>
                        <TextBlock Text="é€‰æ‹©ç±»åž‹:" VerticalAlignment="Center" Margin="0,0,10,0" Foreground="#BBFFFFFF"/>
                        <ComboBox Width="150" 
                                  ItemsSource="{Binding DataContext.DoorTypes, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                  DisplayMemberPath="Name"
                                  SelectedValuePath="KeyId"
                                  SelectedValue="{Binding SelectedDoorTypeKeyId}"
                                  Padding="5" VerticalContentAlignment="Center"/>
                        <TextBlock Text="(ä¿®æ”¹å°†è‡ªåŠ¨åŒæ­¥è‡³æ•°æ®åº“)" VerticalAlignment="Center" Margin="10,0" Foreground="#8800FFFF" FontSize="11" FontStyle="Italic"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button Command="{Binding SaveBitConfigsCommand}" Content="ðŸ’¾ åŒæ­¥æ­¤ç‚¹è¡¨" Padding="12,0" Margin="5,0" Style="{StaticResource ActionButton}" Height="26" Background="#2E7D32" Foreground="White" ToolTip="å¼ºåˆ¶å°†å†…å­˜ä¸­çš„ç‚¹è¡¨é…ç½®åŒæ­¥è‡³æ•°æ®åº“"/>
                        <Button Command="{Binding AddBitCommand}" Content="âž• æ·»åŠ ç‚¹ä½" Padding="12,0" Margin="5,0" Style="{StaticResource ActionButton}" Height="26"/>
                        <Button Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.LoadDataCommand}" Content="ðŸ”„ åˆ·æ–°" Padding="12,0" Margin="5,0" Style="{StaticResource ActionButton}" Height="26" Background="#007ACC" Foreground="White"/>
                    </StackPanel>
                </Grid>

                <Border Grid.Row="4" BorderBrush="#33FFFFFF" BorderThickness="1" CornerRadius="4" Background="#11FFFFFF">
                    <DataGrid ItemsSource="{Binding BitConfigs}" AutoGenerateColumns="False" 
                              CanUserAddRows="False" IsReadOnly="True" Background="Transparent" BorderThickness="0" 
                              MinHeight="250"
                              RowHeaderWidth="0"
                              VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Auto"
                              GridLinesVisibility="All"
                              HorizontalGridLinesBrush="#22FFFFFF"
                              VerticalGridLinesBrush="#22FFFFFF">
                        <DataGrid.ColumnHeaderStyle>
                            <Style TargetType="DataGridColumnHeader">
                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                <Setter Property="Padding" Value="5,8"/>
                                <Setter Property="Background" Value="#22FFFFFF"/>
                                <Setter Property="Foreground" Value="#BBFFFFFF"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                <Setter Property="BorderBrush" Value="#33FFFFFF"/>
                            </Style>
                        </DataGrid.ColumnHeaderStyle>
                        <DataGrid.CellStyle>
                            <Style TargetType="DataGridCell">
                                <Setter Property="VerticalContentAlignment" Value="Center"/>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="#44007ACC"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.CellStyle>
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Description}" Width="160">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="ç‚¹ä½æè¿°" ToolTip="ç‚¹ä½çš„åŠŸèƒ½æè¿° (å¦‚ï¼šå¼€é—¨åˆ°ä½)"/>
                                </DataGridTextColumn.Header>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Margin" Value="5,0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <DataGridTextColumn Binding="{Binding ByteOffset}" Width="50">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="åç§»" ToolTip="å­—èŠ‚åç§»é‡ (ç›¸å¯¹äºŽé—¨å•å…ƒçš„èµ·å§‹åœ°å€)"/>
                                </DataGridTextColumn.Header>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Binding="{Binding BitIndex}" Width="40">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="ä½" ToolTip="ä½ç´¢å¼• (0-7)"/>
                                </DataGridTextColumn.Header>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Binding="{Binding DataType}" Width="60">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="ç±»åž‹" ToolTip="æ•°æ®ç±»åž‹ (å¦‚: Bool, Int16ç­‰)"/>
                                </DataGridTextColumn.Header>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>


                            <DataGridTemplateColumn Width="120">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="åˆ†ç±»" ToolTip="ç‚¹ä½åˆ†ç±»ID (ç”¨äºŽå¼¹çª—åˆ†æ æ˜¾ç¤º)"/>
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ComboBox ItemsSource="{Binding DataContext.BitCategories, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                  SelectedValue="{Binding CategoryId, UpdateSourceTrigger=PropertyChanged}"
                                                  SelectedValuePath="Id"
                                                  BorderThickness="0" Background="Transparent">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding Icon}" Width="20" Margin="0,0,5,0" HorizontalAlignment="Center"/>
                                                        <TextBlock Text="{Binding Name}"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTextColumn Binding="{Binding HeaderPriority}" Width="55">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="å¤´ä¼˜" ToolTip="å¤´éƒ¨çŠ¶æ€æ˜¾ç¤ºä¼˜å…ˆçº§ (æ•°å€¼è¶Šå¤§è¶Šä¼˜å…ˆæ˜¾ç¤º)"/>
                                </DataGridTextColumn.Header>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Binding="{Binding ImagePriority}" Width="55">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="å›¾ä¼˜" ToolTip="ä¸­é—´å›¾å½¢æ˜¾ç¤ºä¼˜å…ˆçº§ (æ•°å€¼è¶Šå¤§è¶Šä¼˜å…ˆæ˜¾ç¤º)"/>
                                </DataGridTextColumn.Header>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Binding="{Binding BottomPriority}" Width="55">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="åº•ä¼˜" ToolTip="åº•éƒ¨çŠ¶æ€æ˜¾ç¤ºä¼˜å…ˆçº§ (æ•°å€¼è¶Šå¤§è¶Šä¼˜å…ˆæ˜¾ç¤º)"/>
                                </DataGridTextColumn.Header>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <!-- é¢œè‰²ç»„ -->
                            <DataGridTemplateColumn Width="110">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="é«˜è‰²" ToolTip="é«˜ç”µå¹³(1)æ—¶çš„çŠ¶æ€ç¯é¢œè‰²ç´¢å¼•"/>
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ComboBox ItemsSource="{Binding DataContext.BitColors, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                  SelectedValue="{Binding HighColorId, UpdateSourceTrigger=PropertyChanged}"
                                                  SelectedValuePath="Id" BorderThickness="0" Background="Transparent">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Width="12" Height="12" CornerRadius="6" Background="{Binding ColorValue}" Margin="0,0,8,0" BorderBrush="#33FFFFFF" BorderThickness="1"/>
                                                        <TextBlock Text="{Binding ColorName}"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Width="110">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="ä½Žè‰²" ToolTip="ä½Žç”µå¹³(0)æ—¶çš„çŠ¶æ€ç¯é¢œè‰²ç´¢å¼•"/>
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ComboBox ItemsSource="{Binding DataContext.BitColors, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                  SelectedValue="{Binding LowColorId, UpdateSourceTrigger=PropertyChanged}"
                                                  SelectedValuePath="Id" BorderThickness="0" Background="Transparent">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Width="12" Height="12" CornerRadius="6" Background="{Binding ColorValue}" Margin="0,0,8,0" BorderBrush="#33FFFFFF" BorderThickness="1"/>
                                                        <TextBlock Text="{Binding ColorName}"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Width="110">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="å¤´è‰²" ToolTip="å¤´éƒ¨æŒ‡ç¤ºç¯æˆ–æ–‡å­—æ¿€æ´»æ—¶çš„é¢œè‰²ç´¢å¼•"/>
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ComboBox ItemsSource="{Binding DataContext.BitColors, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                  SelectedValue="{Binding HeaderColorId, UpdateSourceTrigger=PropertyChanged}"
                                                  SelectedValuePath="Id" BorderThickness="0" Background="Transparent">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Width="12" Height="12" CornerRadius="6" Background="{Binding ColorValue}" Margin="0,0,8,0" BorderBrush="#33FFFFFF" BorderThickness="1"/>
                                                        <TextBlock Text="{Binding ColorName}"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Width="110">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="åº•è‰²" ToolTip="åº•éƒ¨æŒ‡ç¤ºç¯æˆ–æ–‡å­—æ¿€æ´»æ—¶çš„é¢œè‰²ç´¢å¼•"/>
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ComboBox ItemsSource="{Binding DataContext.BitColors, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                  SelectedValue="{Binding BottomColorId, UpdateSourceTrigger=PropertyChanged}"
                                                  SelectedValuePath="Id" BorderThickness="0" Background="Transparent">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Width="12" Height="12" CornerRadius="6" Background="{Binding ColorValue}" Margin="0,0,8,0" BorderBrush="#33FFFFFF" BorderThickness="1"/>
                                                        <TextBlock Text="{Binding ColorName}"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- å›¾å½¢å (GraphicName) -->
                            <DataGridTemplateColumn Width="120">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="å›¾å½¢å" ToolTip="å…³è”çš„çŸ¢é‡å›¾å½¢èµ„æºåç§°"/>
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ComboBox ItemsSource="{Binding DataContext.GraphicGroups, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                  SelectedValue="{Binding GraphicName, UpdateSourceTrigger=PropertyChanged}"
                                                  DisplayMemberPath="GroupName" SelectedValuePath="GroupName"
                                                  BorderThickness="0" Background="Transparent"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- æ—¥å¿— (LogTypeId) -->
                            <DataGridTemplateColumn Width="100">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="æ—¥å¿—" ToolTip="æ—¥å¿—è®°å½•è§„åˆ™ (1:æ™®é€š, 2:æŠ¥è­¦)"/>
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ComboBox ItemsSource="{Binding DataContext.LogTypes, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                  SelectedValue="{Binding LogTypeId, UpdateSourceTrigger=PropertyChanged}"
                                                  DisplayMemberPath="Name" SelectedValuePath="Id"
                                                  BorderThickness="0" Background="Transparent"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTextColumn Binding="{Binding SortOrder}" Width="55">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="æŽ’åº" ToolTip="åœ¨ç‚¹è¡¨åŠå…¶å®ƒåˆ—è¡¨ä¸­çš„æ˜¾ç¤ºé¡ºåº"/>
                                </DataGridTextColumn.Header>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTemplateColumn Width="90">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="æ“ä½œ" ToolTip="åˆ é™¤æˆ–ä¿®æ”¹è¯¥è¡Œè®°å½•"/>
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <Button Command="{Binding DataContext.StartEditBitCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" 
                                                    CommandParameter="{Binding}"
                                                    Content="âœï¸" Foreground="#007ACC" Background="Transparent" BorderThickness="0" 
                                                    VerticalAlignment="Center" Cursor="Hand" FontSize="14" Margin="0,0,10,0" ToolTip="ä¿®æ”¹æ­¤ç‚¹ä½"/>
                                            <Button Command="{Binding DataContext.RemoveBitCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" 
                                                    CommandParameter="{Binding}"
                                                    Content="ðŸ—‘" Foreground="#FF5555" Background="Transparent" BorderThickness="0" 
                                                    VerticalAlignment="Center" Cursor="Hand" FontSize="14" ToolTip="ç‰©ç†åˆ é™¤æ­¤ç‚¹ä½"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>

                <StackPanel Grid.Row="5" Margin="0,10,0,0">
                    <TextBlock Text="* æç¤ºï¼šç‚¹è¡¨æ˜¯åŸºäºŽé—¨ç±»åž‹å…±äº«çš„ã€‚åœ¨æ­¤ä¿®æ”¹å°†å½±å“æ‰€æœ‰åŒç±»åž‹çš„é—¨ã€‚" 
                               Foreground="#88FFFFFF" FontSize="11" FontStyle="Italic"/>
                    <TextBlock Text="* åœ°å€è§„åˆ™ï¼šModbusç±»åž‹ä¸ºå¯„å­˜å™¨åç§»(16ä½)ï¼›S7åè®®ä¸ºå­—èŠ‚åç§»+ä½åç§»(0-7)ã€‚" 
                               Foreground="#AA00FFFF" Margin="0,5,0,0" FontSize="11" FontStyle="Italic"/>
                </StackPanel>

                <!-- ç¼–è¾‘å¼¹çª— (DoorBit) -->
                <Popup IsOpen="{Binding IsBitEditPopupOpen}" Placement="Center" AllowsTransparency="True" StaysOpen="False">
                    <Border Background="#1E1E1E" BorderBrush="#007ACC" BorderThickness="2" CornerRadius="8" Padding="20" Width="500">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="15" ShadowDepth="0" Color="Black" Opacity="0.8"/>
                        </Border.Effect>
                        <StackPanel>
                            <TextBlock Text="ðŸ“ ä¿®æ”¹é—¨ç‚¹ä½è¯¦æƒ…" FontSize="18" FontWeight="Bold" Foreground="#007ACC" Margin="0,0,0,15"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="ç‚¹ä½æè¿°:" VerticalAlignment="Center" Margin="0,5"/>
                                <TextBox Grid.Column="1" Grid.ColumnSpan="3" Text="{Binding EditingBit.Description}" Margin="5"/>

                                <TextBlock Grid.Row="1" Text="å­—èŠ‚åç§»:" VerticalAlignment="Center" Margin="0,5"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding EditingBit.ByteOffset}" Margin="5"/>
                                <TextBlock Grid.Row="1" Grid.Column="2" Text="ä½ç´¢å¼•:" VerticalAlignment="Center" Margin="10,5,0,5"/>
                                <TextBox Grid.Row="1" Grid.Column="3" Text="{Binding EditingBit.BitIndex}" Margin="5"/>

                                <TextBlock Grid.Row="2" Text="æ•°æ®ç±»åž‹:" VerticalAlignment="Center" Margin="0,5"/>
                                <ComboBox Grid.Row="2" Grid.Column="1" Text="{Binding EditingBit.DataType}" IsEditable="True" Margin="5">
                                    <sys:String>Bool</sys:String>
                                    <sys:String>Word</sys:String>
                                    <sys:String>DWord</sys:String>
                                    <sys:String>Float</sys:String>
                                </ComboBox>
                                <TextBlock Grid.Row="2" Grid.Column="2" Text="æŽ’åºåºå·:" VerticalAlignment="Center" Margin="10,5,0,5"/>
                                <TextBox Grid.Row="2" Grid.Column="3" Text="{Binding EditingBit.SortOrder}" Margin="5"/>
                                
                                <TextBlock Grid.Row="3" Text="ç‚¹ä½åˆ†ç±»:" VerticalAlignment="Center" Margin="0,5"/>
                                <ComboBox Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="3" 
                                          ItemsSource="{Binding DataContext.BitCategories, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                          SelectedValue="{Binding EditingBit.CategoryId}"
                                          SelectedValuePath="Id" DisplayMemberPath="Name" Margin="5"/>

                                <TextBlock Grid.Row="4" Text="é«˜ç”µå¹³è‰²:" VerticalAlignment="Center" Margin="0,5"/>
                                <ComboBox Grid.Row="4" Grid.Column="1" 
                                          ItemsSource="{Binding DataContext.BitColors, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                          SelectedValue="{Binding EditingBit.HighColorId}"
                                          SelectedValuePath="Id" DisplayMemberPath="ColorName" Margin="5"/>
                                <TextBlock Grid.Row="4" Grid.Column="2" Text="ä½Žç”µå¹³è‰²:" VerticalAlignment="Center" Margin="10,5,0,5"/>
                                <ComboBox Grid.Row="4" Grid.Column="3" 
                                          ItemsSource="{Binding DataContext.BitColors, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                          SelectedValue="{Binding EditingBit.LowColorId}"
                                          SelectedValuePath="Id" DisplayMemberPath="ColorName" Margin="5"/>

                                <TextBlock Grid.Row="5" Text="å¤´ä¼˜/è‰²:" VerticalAlignment="Center" Margin="0,5"/>
                                <StackPanel Grid.Row="5" Grid.Column="1" Orientation="Horizontal">
                                    <TextBox Text="{Binding EditingBit.HeaderPriority}" Width="40" Margin="5"/>
                                    <ComboBox ItemsSource="{Binding DataContext.BitColors, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                              SelectedValue="{Binding EditingBit.HeaderColorId}"
                                              SelectedValuePath="Id" DisplayMemberPath="ColorName" Width="80" Margin="5"/>
                                </StackPanel>
                                <TextBlock Grid.Row="5" Grid.Column="2" Text="åº•ä¼˜/è‰²:" VerticalAlignment="Center" Margin="10,5,0,5"/>
                                <StackPanel Grid.Row="5" Grid.Column="3" Orientation="Horizontal">
                                    <TextBox Text="{Binding EditingBit.BottomPriority}" Width="40" Margin="5"/>
                                    <ComboBox ItemsSource="{Binding DataContext.BitColors, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                              SelectedValue="{Binding EditingBit.BottomColorId}"
                                              SelectedValuePath="Id" DisplayMemberPath="ColorName" Width="80" Margin="5"/>
                                </StackPanel>

                                <TextBlock Grid.Row="6" Text="å›¾å½¢åç§°:" VerticalAlignment="Center" Margin="0,5"/>
                                <ComboBox Grid.Row="6" Grid.Column="1" Grid.ColumnSpan="3"
                                          ItemsSource="{Binding DataContext.GraphicGroups, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                          SelectedValue="{Binding EditingBit.GraphicName}"
                                          SelectedValuePath="GroupName" DisplayMemberPath="GroupName" Margin="5"/>

                                <TextBlock Grid.Row="7" Text="çº§åˆ«/è®°å½•:" VerticalAlignment="Center" Margin="0,5"/>
                                <StackPanel Grid.Row="7" Grid.Column="1" Grid.ColumnSpan="3" Orientation="Horizontal">
                                    <ComboBox ItemsSource="{Binding DataContext.LogTypes, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                              SelectedValue="{Binding EditingBit.LogTypeId}"
                                              SelectedValuePath="Id" DisplayMemberPath="Name" Width="150" Margin="5"/>
                                    <TextBlock Text="* ç”¨äºŽæ—¥å¿—è¿‡æ»¤" Foreground="#88FFFFFF" VerticalAlignment="Center" Margin="10,0"/>
                                </StackPanel>
                            </Grid>

                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                                <Button Content="å–æ¶ˆ" Command="{Binding CancelEditBitCommand}" Width="80" Margin="0,0,10,0" Padding="5" Style="{StaticResource ActionButton}"/>
                                <Button Content="ç¡®å®šä¿®æ”¹" Command="{Binding ConfirmEditBitCommand}" Width="100" Background="#007ACC" Foreground="White" Padding="5" Style="{StaticResource ActionButton}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Popup>
            </Grid>
        </DataTemplate>

    <!-- Right Side Detail Templates -->
    <DataTemplate DataType="{x:Type vm_items:StationConfigItem}">
        <StackPanel Margin="10">
            <TextBlock Text="ç«™å°é…ç½®" FontSize="18" FontWeight="Bold" Margin="0,0,0,20"/>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="ç«™å°åç§°:" VerticalAlignment="Center" Margin="5,8"/>
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Entity.StationName, UpdateSourceTrigger=PropertyChanged}" Margin="5" Padding="5" VerticalContentAlignment="Center" TextChanged="OnNameTextChanged"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="ç«™å°ç¼–å·:" VerticalAlignment="Center" Margin="5,8"/>
                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Entity.StationCode}" Margin="5" Padding="5" VerticalContentAlignment="Center"/>

                <TextBlock Grid.Row="2" Grid.Column="0" Text="ç«™å°ç±»åž‹:" VerticalAlignment="Center" Margin="5,8"/>
                <ComboBox Grid.Row="2" Grid.Column="1" 
                          ItemsSource="{Binding DataContext.StationTypes, RelativeSource={RelativeSource AncestorType=UserControl}}"
                          DisplayMemberPath="Name"
                          SelectedValuePath="Id"
                          SelectedValue="{Binding Entity.StationType}"
                          Margin="5" Padding="5" VerticalContentAlignment="Center"/>

                <TextBlock Grid.Row="3" Grid.Column="0" Text="æŽ’åºåºå·:" VerticalAlignment="Center" Margin="5,8"/>
                <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding Entity.SortOrder}" Margin="5" Padding="5" VerticalContentAlignment="Center"/>
            </Grid>
            <Border Background="#22FFFFFF" CornerRadius="4" Margin="0,15,0,0" Padding="10">
                <StackPanel Orientation="Horizontal">
                    <Path Data="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z" Fill="#88FFFFFF" Width="14" Height="14" Stretch="Uniform" Margin="0,0,10,0"/>
                    <TextBlock Text="è¯´æ˜Žï¼šå²›å¼ç«™å°å°†ä¸Šä¸‹å¹¶åœ¨æ˜¾ç¤ºï¼Œä¾§å¼ç«™å°åž‚ç›´æŽ’åˆ—ã€‚" Foreground="#AAFFFFFF" TextWrapping="Wrap" VerticalAlignment="Center"/>
                </StackPanel>
            </Border>
        </StackPanel>
    </DataTemplate>

    <DataTemplate DataType="{x:Type vm_items:DoorConfigItem}">
        <StackPanel Margin="10">
            <TextBlock Text="é—¨å•å…ƒé…ç½®" FontSize="18" FontWeight="Bold" Margin="0,0,0,20"/>

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="é—¨åç§°/ç¼–å·:" VerticalAlignment="Center" Margin="5,8"/>
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Entity.DoorName, UpdateSourceTrigger=PropertyChanged}" Margin="5" Padding="5" VerticalContentAlignment="Center" TextChanged="OnNameTextChanged"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="é—¨ç±»åž‹:" VerticalAlignment="Center" Margin="5,8"/>
                <ComboBox x:Name="CmbDoorType" Grid.Row="1" Grid.Column="1" 
                          ItemsSource="{Binding DataContext.DoorTypes, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                          DisplayMemberPath="Name" 
                          SelectedValuePath="KeyId" 
                          SelectedValue="{Binding Entity.DoorTypeKeyId}"
                          Margin="5" Padding="5" VerticalContentAlignment="Center"/>

                <TextBlock Grid.Row="2" Grid.Column="0" Text="æŽ’åºåºå·:" VerticalAlignment="Center" Margin="5,8"/>
                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding Entity.SortOrder}" Margin="5" Padding="5" VerticalContentAlignment="Center"/>

                <TextBlock Grid.Row="3" Grid.Column="0" Text="å¸ƒå±€ (è¡ŒÃ—åˆ—):" VerticalAlignment="Center" Margin="5,8"/>
                <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBox Text="{Binding SelectedItem.PopupLayoutRows, ElementName=CmbDoorType, Mode=OneWay}" Width="45" Margin="5,0" Padding="5" ToolTip="Rows (Defined in Door Type)" IsReadOnly="True" Background="#2A2A2A" Foreground="#AAAAAA" BorderBrush="#44FFFFFF"/>
                    <TextBlock Text="Ã—" VerticalAlignment="Center" Foreground="#88FFFFFF" FontWeight="Bold" Margin="5,0"/>
                    <TextBox Text="{Binding SelectedItem.PopupLayoutColumns, ElementName=CmbDoorType, Mode=OneWay}" Width="45" Margin="5,0" Padding="5" ToolTip="Columns (Defined in Door Type)" IsReadOnly="True" Background="#2A2A2A" Foreground="#AAAAAA" BorderBrush="#44FFFFFF"/>
                    <TextBlock Text="(è‡ªåŠ¨åŒæ­¥ç±»åž‹é…ç½®)" VerticalAlignment="Center" Foreground="#66FFFFFF" FontSize="11" Margin="10,0,0,0"/>
                </StackPanel>

                <Separator Grid.Row="4" Grid.ColumnSpan="2" Margin="0,20" Background="#33FFFFFF"/>
                
                <TextBlock Grid.Row="5" Grid.Column="0" Text="é€šè®¯åœ°å€ (å­—èŠ‚):" VerticalAlignment="Center" Margin="5,8"/>
                <StackPanel Grid.Row="5" Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="åç§»é‡:" VerticalAlignment="Center" Margin="5,0" Foreground="#BBFFFFFF"/>
                    <TextBox Text="{Binding Entity.ByteStartAddr}" Width="70" Margin="5,0" Padding="5"/>
                    <TextBlock Text="é•¿åº¦:" VerticalAlignment="Center" Margin="20,0,5,0" Foreground="#BBFFFFFF"/>
                    <TextBox Text="{Binding Entity.ByteLength}" Width="70" Margin="5,0" Padding="5"/>
                </StackPanel>
            </Grid>
            
            <TextBlock Text="æ³¨ï¼šé€šè®¯åœ°å€æ˜¯ç›¸å¯¹äºŽæ‰€å±ž PLC è®¾å¤‡çš„èµ·å§‹åœ°å€ã€‚" Foreground="#88FFFFFF" Margin="0,15,0,0" TextWrapping="Wrap" FontSize="11" FontStyle="Italic"/>
        </StackPanel>
    </DataTemplate>

        <DataTemplate DataType="{x:Type vm_items:PanelGroupConfigItem}">
            <StackPanel Margin="10">
                <TextBlock Text="é¢æ¿ç»„é…ç½®" FontSize="18" FontWeight="Bold" Margin="0,0,0,20"/>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="100"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Text="é¢æ¿ç»„åç§°:" VerticalAlignment="Center" Margin="5"/>
                    <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Entity.GroupName, UpdateSourceTrigger=PropertyChanged}" Margin="5" Padding="5" TextChanged="OnNameTextChanged"/>

                    <TextBlock Grid.Row="1" Grid.Column="0" Text="æŽ’åºåºå·:" VerticalAlignment="Center" Margin="5"/>
                    <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Entity.SortOrder}" Margin="5" Padding="5"/>
                </Grid>
            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type vm_items:PanelConfigItem}">
            <StackPanel Margin="10">
                <TextBlock Text="é¢æ¿å•å…ƒé…ç½®" FontSize="18" FontWeight="Bold" Margin="0,0,0,20"/>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="120"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/> <!-- New row for table header -->
                        <RowDefinition Height="Auto"/> <!-- Row 7: Table Header -->
                        <RowDefinition Height="*"/>    <!-- Row 8: DataGrid -->
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Text="é¢æ¿åç§°:" VerticalAlignment="Center" Margin="5,8"/>
                    <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Entity.PanelName, UpdateSourceTrigger=PropertyChanged}" Margin="5" Padding="5" VerticalContentAlignment="Center" TextChanged="OnNameTextChanged"/>

                    <TextBlock Grid.Row="1" Grid.Column="0" Text="é¢æ¿ç±»åž‹:" VerticalAlignment="Center" Margin="5,8"/>
                    <ComboBox Grid.Row="1" Grid.Column="1" 
                              ItemsSource="{Binding DataContext.PanelTypes, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                              DisplayMemberPath="Name" 
                              SelectedValuePath="KeyId" 
                              SelectedValue="{Binding Entity.PanelTypeKeyId}"
                              Margin="5" Padding="5" VerticalContentAlignment="Center"/>

                    <TextBlock Grid.Row="2" Grid.Column="0" Text="æŽ’åºåºå·:" VerticalAlignment="Center" Margin="5,8"/>
                    <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding Entity.SortOrder}" Margin="5" Padding="5" VerticalContentAlignment="Center"/>

                    <TextBlock Grid.Row="3" Grid.Column="0" Text="æ ‡é¢˜ä½ç½®:" VerticalAlignment="Center" Margin="5,8"/>
                    <ComboBox Grid.Row="3" Grid.Column="1" SelectedValue="{Binding Entity.TitlePosition}" SelectedValuePath="Tag" Margin="5" Padding="5" VerticalContentAlignment="Center">
                        <ComboBoxItem Content="é¡¶éƒ¨ (æ˜¾ç¤ºåœ¨ç‚¹ä½ä¸Šæ–¹)" Tag="1"/>
                        <ComboBoxItem Content="åº•éƒ¨ (æ˜¾ç¤ºåœ¨ç‚¹ä½ä¸‹æ–¹)" Tag="2"/>
                    </ComboBox>

                    <TextBlock Grid.Row="4" Grid.Column="0" Text="å¸ƒå±€ (è¡ŒÃ—åˆ—):" VerticalAlignment="Center" Margin="5,8"/>
                    <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBox Text="{Binding Entity.LayoutRows}" Width="50" Margin="5,0" Padding="5" ToolTip="Rows"/>
                        <TextBlock Text="Ã—" VerticalAlignment="Center" Foreground="#88FFFFFF" FontWeight="Bold" Margin="5,0"/>
                        <TextBox Text="{Binding Entity.LayoutColumns}" Width="50" Margin="5,0" Padding="5" ToolTip="Columns"/>
                    </StackPanel>

                    <Separator Grid.Row="5" Grid.ColumnSpan="2" Margin="0,20" Background="#33FFFFFF"/>

                    <TextBlock Grid.Row="6" Grid.Column="0" Text="é€šè®¯åœ°å€ (å­—èŠ‚):" VerticalAlignment="Center" Margin="5,8"/>
                    <StackPanel Grid.Row="6" Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="åç§»é‡:" VerticalAlignment="Center" Margin="5,0" Foreground="#BBFFFFFF"/>
                        <TextBox Text="{Binding Entity.ByteStartAddr}" Width="75" Margin="5,0" Padding="5"/>
                        <TextBlock Text="é•¿åº¦:" VerticalAlignment="Center" Margin="20,0,5,0" Foreground="#BBFFFFFF"/>
                        <TextBox Text="{Binding Entity.ByteLength}" Width="75" Margin="5,0" Padding="5"/>
                    </StackPanel>

                    <!-- é¢æ¿ç‚¹è¡¨é…ç½®åŒº -->
                    <Grid Grid.Row="7" Grid.ColumnSpan="2" Margin="0,20,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="é¢æ¿ç‚¹è¡¨é…ç½®" FontSize="14" FontWeight="Bold" Foreground="#00FFFF" VerticalAlignment="Center" Margin="5,0,20,0"/>
                             <TextBlock Text="(æ¯ä¸ªé¢æ¿ç‹¬ç«‹é…ç½®ï¼Œä¿®æ”¹è‡ªåŠ¨åŒæ­¥)" VerticalAlignment="Center" Margin="0,0,10,0" Foreground="#8800FFFF" FontSize="11" FontStyle="Italic"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <Button Command="{Binding SaveBitConfigsCommand}" Content="ðŸ’¾ åŒæ­¥æ­¤ç‚¹è¡¨" Padding="12,0" Margin="5,0" Style="{StaticResource ActionButton}" Height="26" Background="#2E7D32" Foreground="White" ToolTip="å¼ºåˆ¶å°†å†…å­˜ä¸­çš„ç‚¹è¡¨åŒæ­¥è‡³æ•°æ®åº“"/>
                            <Button Command="{Binding AddBitCommand}" Content="âž• æ·»åŠ ç‚¹ä½" Padding="12,0" Margin="5,0" Style="{StaticResource ActionButton}" Height="26"/>
                        </StackPanel>
                    </Grid>

                    <Border Grid.Row="8" Grid.ColumnSpan="2" BorderBrush="#33FFFFFF" BorderThickness="1" CornerRadius="4" Background="#11FFFFFF">
                        <DataGrid ItemsSource="{Binding BitConfigs}" AutoGenerateColumns="False" 
                                  CanUserAddRows="False" IsReadOnly="True" Background="Transparent" BorderThickness="0" 
                                  MinHeight="250"
                                  RowHeaderWidth="0"
                                  VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Auto"
                                  GridLinesVisibility="All"
                                  HorizontalGridLinesBrush="#22FFFFFF"
                                  VerticalGridLinesBrush="#22FFFFFF">
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                    <Setter Property="Padding" Value="5,8"/>
                                    <Setter Property="Background" Value="#22FFFFFF"/>
                                    <Setter Property="Foreground" Value="#BBFFFFFF"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                    <Setter Property="BorderBrush" Value="#33FFFFFF"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="VerticalContentAlignment" Value="Center"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#44007ACC"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.CellStyle>
                            <DataGrid.Columns>
                                <DataGridTextColumn Binding="{Binding Description}" Width="160">
                                    <DataGridTextColumn.Header>
                                        <TextBlock Text="ç‚¹ä½æè¿°"/>
                                    </DataGridTextColumn.Header>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                            <Setter Property="Margin" Value="5,0"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                
                                <DataGridTextColumn Binding="{Binding ByteOffset}" Width="50">
                                    <DataGridTextColumn.Header>
                                        <TextBlock Text="åç§»"/>
                                    </DataGridTextColumn.Header>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center"/>
                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>

                                <DataGridTextColumn Binding="{Binding BitIndex}" Width="40">
                                    <DataGridTextColumn.Header>
                                        <TextBlock Text="ä½"/>
                                    </DataGridTextColumn.Header>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center"/>
                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>

                                <DataGridTemplateColumn Width="110">
                                    <DataGridTemplateColumn.Header>
                                        <TextBlock Text="é«˜è‰²" ToolTip="é«˜ç”µå¹³(1)æ—¶çš„çŠ¶æ€ç¯é¢œè‰²ç´¢å¼•"/>
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <ComboBox ItemsSource="{Binding DataContext.BitColors, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                      SelectedValue="{Binding HighColorId, UpdateSourceTrigger=PropertyChanged}"
                                                      SelectedValuePath="Id" BorderThickness="0" Background="Transparent">
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <Border Width="12" Height="12" CornerRadius="6" Background="{Binding ColorValue}" Margin="0,0,8,0" BorderBrush="#33FFFFFF" BorderThickness="1"/>
                                                            <TextBlock Text="{Binding ColorName}"/>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTemplateColumn Width="110">
                                    <DataGridTemplateColumn.Header>
                                        <TextBlock Text="ä½Žè‰²" ToolTip="ä½Žç”µå¹³(0)æ—¶çš„çŠ¶æ€ç¯é¢œè‰²ç´¢å¼•"/>
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <ComboBox ItemsSource="{Binding DataContext.BitColors, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                      SelectedValue="{Binding LowColorId, UpdateSourceTrigger=PropertyChanged}"
                                                      SelectedValuePath="Id" BorderThickness="0" Background="Transparent">
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <Border Width="12" Height="12" CornerRadius="6" Background="{Binding ColorValue}" Margin="0,0,8,0" BorderBrush="#33FFFFFF" BorderThickness="1"/>
                                                            <TextBlock Text="{Binding ColorName}"/>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTemplateColumn Width="90">
                                    <DataGridTemplateColumn.Header>
                                        <TextBlock Text="æ—¥å¿—" ToolTip="æ—¥å¿—è®°å½•ç±»åž‹"/>
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <ComboBox ItemsSource="{Binding DataContext.LogTypes, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                      DisplayMemberPath="Name"
                                                      SelectedValuePath="Id"
                                                      SelectedValue="{Binding LogTypeId, UpdateSourceTrigger=PropertyChanged}"
                                                      BorderThickness="0" Background="Transparent" VerticalContentAlignment="Center"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                
                                <DataGridTextColumn Binding="{Binding SortOrder}" Width="55">
                                    <DataGridTextColumn.Header>
                                        <TextBlock Text="æŽ’åº"/>
                                    </DataGridTextColumn.Header>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center"/>
                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>

                                <DataGridTemplateColumn Width="90">
                                    <DataGridTemplateColumn.Header>
                                        <TextBlock Text="æ“ä½œ" ToolTip="åˆ é™¤æˆ–ä¿®æ”¹è¯¥è¡Œè®°å½•"/>
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Command="{Binding DataContext.StartEditBitCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" 
                                                        CommandParameter="{Binding}"
                                                        Content="âœï¸" Foreground="#007ACC" Background="Transparent" BorderThickness="0" 
                                                        VerticalAlignment="Center" Cursor="Hand" FontSize="14" Margin="0,0,10,0" ToolTip="ä¿®æ”¹æ­¤ç‚¹ä½"/>
                                                <Button Command="{Binding DataContext.RemoveBitCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" 
                                                        CommandParameter="{Binding}"
                                                        Content="ðŸ—‘" Foreground="#FF5555" Background="Transparent" BorderThickness="0" 
                                                        VerticalAlignment="Center" Cursor="Hand" FontSize="14" ToolTip="ç‰©ç†åˆ é™¤æ­¤ç‚¹ä½"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>

                <!-- ç¼–è¾‘å¼¹çª— (PanelBit) -->
                <Popup IsOpen="{Binding IsBitEditPopupOpen}" Placement="Center" AllowsTransparency="True" StaysOpen="False">
                    <Border Background="#1E1E1E" BorderBrush="#9C27B0" BorderThickness="2" CornerRadius="8" Padding="20" Width="400">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="15" ShadowDepth="0" Color="Black" Opacity="0.8"/>
                        </Border.Effect>
                        <StackPanel>
                            <TextBlock Text="ðŸ“ ä¿®æ”¹é¢æ¿ç‚¹ä½è¯¦æƒ…" FontSize="18" FontWeight="Bold" Foreground="#9C27B0" Margin="0,0,0,15"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="ç‚¹ä½æè¿°:" VerticalAlignment="Center" Margin="0,5"/>
                                <TextBox Grid.Column="1" Text="{Binding EditingBit.Description}" Margin="5"/>

                                <TextBlock Grid.Row="1" Text="å­—èŠ‚åç§»:" VerticalAlignment="Center" Margin="0,5"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding EditingBit.ByteOffset}" Margin="5"/>

                                <TextBlock Grid.Row="2" Text="ä½ç´¢å¼•:" VerticalAlignment="Center" Margin="0,5"/>
                                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding EditingBit.BitIndex}" Margin="5"/>

                                <TextBlock Grid.Row="3" Text="é«˜ç”µå¹³è‰²:" VerticalAlignment="Center" Margin="0,5"/>
                                <ComboBox Grid.Row="3" Grid.Column="1" 
                                          ItemsSource="{Binding DataContext.BitColors, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                          SelectedValue="{Binding EditingBit.HighColorId}"
                                          SelectedValuePath="Id" DisplayMemberPath="ColorName" Margin="5"/>

                                <TextBlock Grid.Row="4" Text="ä½Žç”µå¹³è‰²:" VerticalAlignment="Center" Margin="0,5"/>
                                <ComboBox Grid.Row="4" Grid.Column="1" 
                                          ItemsSource="{Binding DataContext.BitColors, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                          SelectedValue="{Binding EditingBit.LowColorId}"
                                          SelectedValuePath="Id" DisplayMemberPath="ColorName" Margin="5"/>

                                <TextBlock Grid.Row="5" Text="æ•°æ®ç±»åž‹:" VerticalAlignment="Center" Margin="0,5"/>
                                <ComboBox Grid.Row="5" Grid.Column="1" Text="{Binding EditingBit.DataType}" IsEditable="True" Margin="5">
                                    <sys:String>Bool</sys:String>
                                    <sys:String>Word</sys:String>
                                </ComboBox>

                                <TextBlock Grid.Row="6" Text="æŽ’åºåºå·:" VerticalAlignment="Center" Margin="0,5"/>
                                <TextBox Grid.Row="6" Grid.Column="1" Text="{Binding EditingBit.SortOrder}" Margin="5"/>

                                <TextBlock Grid.Row="7" Text="æ—¥å¿—ç±»åž‹:" VerticalAlignment="Center" Margin="0,5"/>
                                <ComboBox Grid.Row="7" Grid.Column="1" 
                                          ItemsSource="{Binding DataContext.LogTypes, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                          SelectedValue="{Binding EditingBit.LogTypeId}"
                                          SelectedValuePath="Id" DisplayMemberPath="Name" Margin="5"/>
                            </Grid>

                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                                <Button Content="å–æ¶ˆ" Command="{Binding CancelEditBitCommand}" Width="80" Margin="0,0,10,0" Padding="5" Style="{StaticResource ActionButton}"/>
                                <Button Content="ç¡®å®šä¿®æ”¹" Command="{Binding ConfirmEditBitCommand}" Width="100" Background="#9C27B0" Foreground="White" Padding="5" Style="{StaticResource ActionButton}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Popup>
            </StackPanel>
        </DataTemplate>

    </UserControl.Resources>

    <Grid TextElement.Foreground="White">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300" MinWidth="200"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <Border Grid.Row="0" Grid.ColumnSpan="3" BorderBrush="#33FFFFFF" BorderThickness="0,0,0,1" Padding="10" Background="#11FFFFFF">
            <StackPanel Orientation="Horizontal">
                <Button Command="{Binding LoadCommand}" Content="ðŸ”„ åˆ·æ–°" Margin="0,0,10,0" Padding="18,0" Style="{StaticResource ActionButton}"/>
                <Button Command="{Binding SaveCommand}" Content="ðŸ’¾ ä¿å­˜é…ç½®" Margin="0,0,20,0" Padding="20,0" Background="#007ACC" Foreground="White" FontWeight="Bold" Style="{StaticResource ActionButton}"/>
                
                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="0,0,10,0" Background="#44FFFFFF"/>

                <Button Command="{Binding ShowCategoryManagerCommand}" Content="âš™ ç±»åˆ«ç®¡ç†" Margin="0,0,10,0" Padding="15,0" Style="{StaticResource ActionButton}" ToolTip="ç®¡ç†ç‚¹ä½åˆ†ç±»å­—å…¸"/>
                <Button Command="{Binding ShowColorManagerCommand}" Content="ðŸŽ¨ é¢œè‰²ç®¡ç†" Margin="0,0,20,0" Padding="15,0" Style="{StaticResource ActionButton}" ToolTip="ç®¡ç†ç‚¹ä½é¢œè‰²å­—å…¸"/>

                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="0,0,10,0" Background="#44FFFFFF"/>

                <Button Command="{Binding AddStationCommand}" Content="âž• æ·»åŠ ç«™å°" Margin="0,0,5,0" Padding="18,0" Style="{StaticResource ActionButton}"/>
                <TextBlock Text="|" Foreground="#44FFFFFF" VerticalAlignment="Center" Margin="5,0"/>
                
                <Button Command="{Binding AddDoorGroupCommand}" Content="âž• é—¨ç»„" Margin="0,0,5,0" Padding="15,0" Style="{StaticResource ActionButton}" ToolTip="æ·»åŠ é—¨ç»„"/>
                <Button Command="{Binding AddPanelGroupCommand}" Content="âž• é¢æ¿ç»„" Margin="0,0,5,0" Padding="15,0" Style="{StaticResource ActionButton}" ToolTip="æ·»åŠ é¢æ¿ç»„"/>
                <TextBlock Text="|" Foreground="#44FFFFFF" VerticalAlignment="Center" Margin="5,0"/>
                
                <Button Command="{Binding AddDoorCommand}" Content="âž• é—¨" Margin="0,0,5,0" Padding="15,0" Style="{StaticResource ActionButton}" ToolTip="æ·»åŠ å•ä¸ªé—¨"/>
                <Button Command="{Binding AddPanelCommand}" Content="âž• é¢æ¿" Margin="0,0,5,0" Padding="15,0" Style="{StaticResource ActionButton}" ToolTip="æ·»åŠ å•ä¸ªé¢æ¿"/>
                
                <Button Command="{Binding RemoveCommand}" Content="âŒ åˆ é™¤é€‰ä¸­" Margin="20,0,0,0" Padding="18,0" Foreground="#FF5555" Style="{StaticResource ActionButton}"/>
            </StackPanel>
        </Border>

        <!-- Left Tree -->
        <Border Grid.Row="1" Grid.Column="0" BorderBrush="#33FFFFFF" BorderThickness="0,0,1,0" Background="#aa000000">
            <TreeView ItemsSource="{Binding Stations}" BorderThickness="0" Background="Transparent" Foreground="White">
                <TreeView.Resources>
                    <HierarchicalDataTemplate DataType="{x:Type vm_items:StationConfigItem}" ItemsSource="{Binding Children}">
                        <StackPanel Orientation="Horizontal" Margin="2">
                            <Path Data="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" Fill="#2196F3" Style="{StaticResource IconStyle}"/>
                            <TextBlock Text="{Binding Name}" FontWeight="Bold"/>
                        </StackPanel>
                    </HierarchicalDataTemplate>

                    <HierarchicalDataTemplate DataType="{x:Type vm_items:DoorGroupConfigItem}" ItemsSource="{Binding Children}">
                        <StackPanel Orientation="Horizontal" Margin="2">
                            <Path Data="M4,18V20H8V18H4M4,14V16H8V14H4M10,18V20H14V18H10M10,14V16H14V14H10M16,18V20H20V18H16M16,14V16H20V14H16M2,22H22V24H2V22M3,10H21V12H3V10M4,6H20V8H4V6M5,2H19V4H5V2Z" Fill="#FF9800" Style="{StaticResource IconStyle}"/>
                            <TextBlock Text="{Binding Name}"/>
                        </StackPanel>
                    </HierarchicalDataTemplate>

                    <HierarchicalDataTemplate DataType="{x:Type vm_items:PanelGroupConfigItem}" ItemsSource="{Binding Children}">
                        <StackPanel Orientation="Horizontal" Margin="2">
                            <Path Data="M21,16V4H3V16H21M21,2A2,2 0 0,1 23,4V16A2,2 0 0,1 21,18H3A2,2 0 0,1 1,16V4A2,2 0 0,1 3,2H21M11,6H13V14H11V6M7,6H9V14H7V6M15,6H17V14H15V6Z" Fill="#9C27B0" Style="{StaticResource IconStyle}"/>
                            <TextBlock Text="{Binding Name}"/>
                        </StackPanel>
                    </HierarchicalDataTemplate>

                    <DataTemplate DataType="{x:Type vm_items:DoorConfigItem}">
                        <StackPanel Orientation="Horizontal" Margin="2">
                            <Path Data="M19,19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M16.5,13V18H7.5V13H16.5M12,15V18H12V15M12,15V13H12V15Z" Fill="#4CAF50" Style="{StaticResource IconStyle}"/>
                            <TextBlock Text="{Binding Name}"/>
                        </StackPanel>
                    </DataTemplate>

                    <DataTemplate DataType="{x:Type vm_items:PanelConfigItem}">
                        <StackPanel Orientation="Horizontal" Margin="2">
                            <Path Data="M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M5,19V5H19V19H5M7,7H17V9H7V7M7,11H17V13H7V11M7,15H17V17H7V15Z" Fill="#00BCD4" Style="{StaticResource IconStyle}"/>
                            <TextBlock Text="{Binding Name}"/>
                        </StackPanel>
                    </DataTemplate>
                </TreeView.Resources>
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="SelectedItemChanged">
                        <i:InvokeCommandAction Command="{Binding SelectedItemChangedCommand}" CommandParameter="{Binding SelectedItem, RelativeSource={RelativeSource AncestorType=TreeView}}"/>
                    </i:EventTrigger>
                </i:Interaction.Triggers>
                <TreeView.ItemContainerStyle>
                    <Style TargetType="{x:Type TreeViewItem}">
                        <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}"/>
                        <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}"/>
                        <Setter Property="Foreground" Value="White"/>
                    </Style>
                </TreeView.ItemContainerStyle>
            </TreeView>
        </Border>

        <!-- Splitter -->
        <GridSplitter Grid.Row="1" Grid.Column="1" Width="5" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="#33FFFFFF"/>

        <!-- Right Content -->
        <Border Grid.Row="1" Grid.Column="2" Padding="20" Background="#aa000000">
            <ContentControl Content="{Binding SelectedItem}">
                <ContentControl.Style>
                    <Style TargetType="ContentControl">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding SelectedItem}" Value="{x:Null}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate>
                                            <Grid>
                                                <TextBlock Text="è¯·ä»Žå·¦ä¾§é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œç¼–è¾‘" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="#88FFFFFF" FontSize="16"/>
                                            </Grid>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ContentControl.Style>
            </ContentControl>
        </Border>
    </Grid>
</UserControl>
