# 更改日志 - 实时点位配置列表架构重构

**日期**: 2026-02-02 21:30
**更改类型**: 架构优化 / UI 增强

## 1. 修改摘要 (Summary)
对“实时点位配置列表”进行了架构级重构，实现了“底层数据实体 (Entity)”与“界面显示模型 (UI Wrapper)”的彻底分离。优化了看板的显示密度和业务语义表达。

## 2. 解决的问题 (Problem Solved)
- **代码耦合**: 之前为了 UI 显示，在底层的数据库映射类 `DevicePointConfigEntity` 中添加了大量不属于数据库范围的字段（如全路径、序号等），破坏了模型纯净度。
- **信息不直观**: 
    - 地址和位偏移分离显示，不符合工程习惯。
    - 绑定关系太简单，无法一眼看出某个点位属于哪个站台、哪个门、具备什么功能。
    - 模拟量报警参数隐藏太深，列表无法直接看到报警阈值。
    - 日志配置、状态描述等信息挤在一起，阅读困难。

## 3. 修改详细说明 (Modification Details)
### 架构层面:
- **底层清理**: 从 `DevicePointConfigEntity.cs` 中移除了所有 UI 辅助字段。
- **引入 UI Wrapper**: 新建 `DevicePointRow.cs` 类，作为 `DataGrid` 的专用数据项。该类包含一个 `Entity` 引用，并扩展了动态生成的展示属性。
- **动态全路径生成**: 采用递归算法，根据当前点位的 `KeyId`，从系统缓存中自动拼接 `站台 > 分组 > 对象 > 功能点` 的全路径展示文本。

### UI 表现层面:
- **地址整合**: 实现 `Address.BitIndex` 的一体化显示（仅 Bool 类型加点位标识）。
- **状态全方位看板**:
    - 独立显示 0状态 和 1状态 的物理描述文字，并对激活态（1状态）进行色彩加固。
    - 模拟量显示优化：在一个单元格内分上下两行显示“高限报警”与“低限报警”值。
- **日志细化**: 日志类型（一般/报警）与消息模板拆分为独立列，增加色彩语义。
- **全路径显示**: 将全息路径移至操作列之前，提供点位在系统中的完整上下文。

## 5. UI 视觉微调 (21:38)
- **色彩一致性**: 将 DataGrid 中的“1状态描述”和“同步图标”颜色由绿色改为品牌主题蓝 (`PrimaryBrush`)。
- **原因**: 统一“激活/正向”逻辑的色彩语义，使其与“修改”按钮及物理地址高亮色保持一致。

## 4. 遗留问题与注意事项 (Remaining Issues)
- **性能评估**: 由于全路径是动态拼接的，在点位数量巨大（超过 2000 个）时，初次加载列表可能会有微量延迟。已采用缓存字典预加载技术缓解。
- **站台参数**: 目前全路径主要针对门和面板对象，通用的“站台级参数”路径拼接逻辑目前较简单，后续可根据需求进一步细化。

---
*由 Antigravity 自动记录*
